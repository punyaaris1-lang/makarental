<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Daftar Antrian</title>

<!-- Inject CSS utama -->
<link rel="stylesheet" href="css/app.css">

<style>
/* Style lokal tambahan bila diperlukan */
.form-box{
    max-width:480px;
    margin:auto;
    margin-top:30px;
}
label{
    font-weight:600;
    margin-top:12px;
    display:block;
}
input, select{
    width:100%;
    padding:12px;
    border-radius:12px;
    border:1px solid #ddd;
    margin-top:6px;
}
button{
    width:100%;
    margin-top:18px;
}
.admin-btn{
    text-align:center;
    margin-top:18px;
    font-size:14px;
    opacity:0.6;
    cursor:pointer;
}
</style>
</head>

<body>

<div class="form-box card">
    <h2>Pendaftaran User RTO</h2>

    <label>Nama</label>
    <input type="text" id="nama" placeholder="Nama lengkap">

    <label>Nomor HP</label>
    <input type="text" id="hp" placeholder="08xxxx">

    <label>Plat Nomor</label>
    <input type="text" id="plat" placeholder="AB 1234 CD">

    <label>Pembayaran DP</label>
    <select id="dp">
        <option value="755">DP Lunas 755.000</option>
        <option value="355">DP Cicil 355.000</option>
    </select>

    <button class="btn-primary" onclick="daftar()">DAFTAR</button>

    <div class="admin-btn" onclick="openAdminLogin()">üîê Admin Login</div>
</div>


<!-- ADMIN LOGIN POPUP -->
<div id="adminLoginPopup" class="modal">
    <div class="modal-content card">
        <h3>Masukkan PIN Admin</h3>
        <input type="password" id="adminPin" placeholder="PIN Admin" class="card">
        <button class="btn-primary" onclick="verifyAdmin()">MASUK</button>
        <button class="btn-danger" onclick="closeAdminLogin()">BATAL</button>
        <div id="pinError" style="display:none;color:#ff3b30;margin-top:10px;">PIN salah</div>
    </div>
</div>


<!-- ADMIN PANEL (selalu hidden saat load) -->
<div id="adminPanel" class="modal">
    <div class="modal-content card">
        <h3>ADMIN MODE</h3>
        <p>Anda login sebagai admin.</p>

        <button class="btn-primary" onclick="gotoAdminPanel()">BUKA ADMIN PANEL</button>
        <button class="btn-danger" onclick="logoutAdmin()">LOGOUT ADMIN</button>
    </div>
</div>


<script src="app.js"></script>
<script>
/* =============================
   SISTEM ADMIN KUNCI 100%
   ============================= */
const ADMIN_PIN = "1131";

// PANEL SELALU DIHIDDEN SAAT PAGE LOAD
document.getElementById("adminPanel").style.display = "none";
document.getElementById("adminLoginPopup").style.display = "none";

function openAdminLogin(){
    document.getElementById("adminPin").value = "";
    document.getElementById("pinError").style.display = "none";
    document.getElementById("adminLoginPopup").style.display = "flex";
}

function closeAdminLogin(){
    document.getElementById("adminLoginPopup").style.display = "none";
}

function verifyAdmin(){
    const pin = document.getElementById("adminPin").value.trim();
    if(pin === ADMIN_PIN){
        localStorage.setItem("isAdminLoggedIn","yes");
        closeAdminLogin();
        document.getElementById("adminPanel").style.display = "flex"; 
    } else {
        document.getElementById("pinError").style.display = "block";
    }
}

function gotoAdminPanel(){
    window.location.href = "admin.html";
}

function logoutAdmin(){
    localStorage.removeItem("isAdminLoggedIn");
    document.getElementById("adminPanel").style.display = "none";
}

/* =============================
   SISTEM PENDAFTARAN USER
   ============================= */
function daftar(){
    const nama = document.getElementById("nama").value.trim();
    const hp   = document.getElementById("hp").value.trim();
    const plat = document.getElementById("plat").value.trim();
    const dp   = document.getElementById("dp").value;

    if(!nama || !hp || !plat){
        alert("Isi semua data!");
        return;
    }

    const user = {
        id: Date.now().toString(),
        nama: nama,
        hp: hp,
        plat: plat,
        dp: dp,
        mulai: new Date().toISOString().slice(0,10),
        payments: [],
        freeParts: [],
        makaPlus: {active:false, activatedAt:null}
    };

    saveUser(user);
    alert("Pendaftaran berhasil!");
    window.location.href = "index.html";
}

</script>

</body>
</html>
