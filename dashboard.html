<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MAKA Dashboard</title>
<link rel="stylesheet" href="styles.css">
</head>

<body class="dashboard">

<div class="app-container">

<header class="header">
  <div class="user-info">
    <h1 id="userName">Halo</h1>
    <p>Plat Motor <strong id="userPlate"></strong></p>
  </div>

  <div class="hero-tunggakan">
    <div>
      <h3>TAGIHAN BERJALAN</h3>
      <p>Sampai hari ini</p>
    </div>
    <div>
      <span id="totalBill">Rp 0</span><br>
      <small id="totalDays">0 Hari</small>
    </div>
  </div>
</header>

<section class="icon-grid-section">
<div class="icon-grid">
<a href="calendar.html" class="icon-item">ğŸ“…<p>Kalender</p></a>
<a href="history.html" class="icon-item">ğŸ§¾<p>Riwayat</p></a>
<a href="part_tracker.html" class="icon-item">ğŸ<p>Gratisan</p></a>
<a href="info_mlu.html" class="icon-item">ğŸ“°<p>Info</p></a>
<a href="tips_maka.html" class="icon-item">ğŸ’¡<p>Tips</p></a>
<a href="maka_plus.html" class="icon-item">â­<p>MAKA+</p></a>
</div>
</section>

</div>

<footer class="bottom-nav">
  <a href="lokasi_fc.html" class="nav-item">âš¡<span>FC</span></a>
  <a href="dashboard.html" class="nav-item active">ğŸ <span>Home</span></a>
  <a href="calendar.html" class="nav-item">ğŸ“…<span>Bayar</span></a>
</footer>

<script src="app.js"></script>
<script>
const user = DB.activeUser;
if(!user){ location.href='index.html'; }

user.dpPaidCount = user.dpPaidCount || 0;

document.getElementById('userName').textContent = "Halo, " + user.name;
document.getElementById('userPlate').textContent = user.plate;

let total = 0;
let days = 0;
const today = new Date();
let d = new Date(user.startDate);
d.setDate(d.getDate()+1); // H+1

while(d <= today){
  const ds = d.toISOString().slice(0,10);
  if(!isHoliday(user, ds)){
    total += getDailyRate(user, ds);
    days++;
  }
  d.setDate(d.getDate()+1);
}

document.getElementById('totalBill').textContent = formatIDR(total);
document.getElementById('totalDays').textContent = days + " Hari";
</script>
</body>
</html>
