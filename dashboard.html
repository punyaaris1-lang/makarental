<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MAKA Dashboard</title>

<style>
body{margin:0;font-family:Inter,system-ui;background:#050814;color:#fff}
.app{max-width:520px;margin:auto;padding-bottom:120px}
.header{padding:20px}
.hero{
 background:linear-gradient(135deg,#0f1a3a,#020512);
 border-radius:18px;padding:18px;
 border:1px solid rgba(255,255,255,.08)
}
.hero h3{margin:0;font-size:.7em;color:#7aa2ff}
.hero span{font-size:1.3em;font-weight:800}
.icon-grid{
 display:grid;grid-template-columns:repeat(3,1fr);
 gap:16px;padding:20px
}
.icon{
 background:#0b1324;padding:20px 10px;
 text-align:center;border-radius:16px;
 color:#fff;text-decoration:none;
 border:1px solid rgba(255,255,255,.08)
}
.icon span{display:block;font-size:28px;margin-bottom:6px}
.bottom{
 position:fixed;bottom:0;left:50%;
 transform:translateX(-50%);
 width:100%;max-width:520px;
 height:90px;display:flex;
 background:#020512;border-top:1px solid rgba(255,255,255,.08)
}
.bottom a{flex:1;color:#888;text-align:center;text-decoration:none;padding-top:14px}
.bottom a.active{color:#fff}
</style>
</head>

<body>
<div class="app">
  <div class="header">
    <h1 id="nama"></h1>
    <p>Plat <strong id="plat"></strong></p>

    <div class="hero">
      <h3>TAGIHAN HARI INI</h3>
      <span id="tagihan">Rp 0</span>
    </div>
  </div>

  <div class="icon-grid">
    <a href="calendar.html" class="icon"><span>üìÖ</span>Bayar</a>
    <a href="#" class="icon"><span>üóíÔ∏è</span>Riwayat</a>
    <a href="maka_plus.html" class="icon"><span>‚≠ê</span>MAKA+</a>
  </div>
</div>

<div class="bottom">
 <a href="#" class="active">üè†<br>Home</a>
 <a href="calendar.html">üìÖ<br>Kalender</a>
 <a href="admin.html">‚öôÔ∏è<br>Admin</a>
</div>

<script>
const user=JSON.parse(localStorage.getItem('maka_user'));
const finance=JSON.parse(localStorage.getItem('maka_finance_settings'))||{hwb_rate:80000,cdp_rate:70000};

if(!user)location.href='index.html';

document.getElementById('nama').textContent='Halo '+user.nama;
document.getElementById('plat').textContent=user.plat;

/* HITUNG TAGIHAN SAMPAI HARI INI */
const start=new Date(user.tanggalAmbil);
start.setDate(start.getDate()+1);
const today=new Date();today.setHours(0,0,0,0);

let total=0;
let dpSisa=6-user.dpTerbayar;

for(let d=new Date(start);d<=today;d.setDate(d.getDate()+1)){
 const t=d.getDate();
 let bayar=0;

 if(t===31)continue;

 if(user.dp==='355' && dpSisa>0 && (t===14||t===28)){
   bayar=finance.cdp_rate;
   dpSisa--;
 }else if(user.dp==='755' && (t===14||t===28)){
   continue;
 }else if(t!==14 && t!==28){
   bayar=finance.hwb_rate;
 }

 if(user.makaPlus && new Date(user.makaPlusAktifSejak)<d){
   bayar+=10000;
 }

 total+=bayar;
}

document.getElementById('tagihan').textContent=
 'Rp '+total.toLocaleString('id-ID');
</script>
</body>
</html>
